How things are related:

The parts of views that are used to build compositions (i.e., the forms) are rendered using the `@composition` instance. The views should NOT do anything based directly on the requested URL. The URL is parsed by the app, which is responsible for constructing the `@composition` and its components, like `filters`, `groups`, etc. Both the `@composition` instance, and the various components that make up the composition may have `errors`. The views should inspect all approrpriate objects to find and display relevant errors.

The `composition_url_controller` Stimulus controller is responsible constructing a composition request URL from the page/form's state. The controller has an awareness of the DOM and knows how to extract the data it needs to construct a valid URL (or a URL as valid as possible, based on the user's input).

There is an agreement between the views and the Stimulus controller such that the Stimulus controller can find all the data it needs to constuct the request URL. The page's DOM/structure/classes/IDs don't necessarily need to reflect either the underlying `@composition` structure or the URL structure but in practice all three tends to follow similar patterns for most things. There are some cases, though, where, e.g., the UI may have many `<input>` elements to collect some data, but they are coalesced into a single URL parameter. The view should be built to serve the user, and the Stimulus controller just needs to understand how to query the DOM for the data it needs.

The component models are responsible for parsing relevant parts of the request URL and constructing Ruby instances that make up the `@composition`. For example, `Components::Filter` is responsible for extracting values related to composition filters from the URL, and performing validations on those values. These models don't really care about what the views or Stimulus controller are doing. They only come into play once a URL has already been constructed and requested. They are meant to be resilient to malformed URLs, but assuming the Stimulus controller is doing its job, they generally should be dealing with valid (if incomplete) data.

There is an agreement between the Stimulus controller and the parsing models on how the URL should be constructed. See `api.md` for more info. The URL structure also affects external use cases, like bookmarks, so it should be **very** stable. Even though the Stimulus controller and the parsing models could be updated to change the structure at any time, this should be avoided unless absolutely necessary. Changes that are additive and backwards compatible are fine.
